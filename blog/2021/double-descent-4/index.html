<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Marc  Lafon | Deep double descent explained (4/4)</title>
<meta name="description" content="Marc Lafon's Blog. I use this blog to document my learning notes.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚡ ️</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/blog/2021/double-descent-4/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->



  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-XXXXXXXXX');
  </script>




    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


    <script src="/assets/js/distillpub/template.v2.js"></script>
    <script src="/assets/js/distillpub/transforms.v2.js"></script>
    
  </head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "Deep double descent explained (4/4)",
      "description": "Recent works analyzing over-parameterized regimes.",
      "published": "June 17, 2021",
      "authors": [
        
        {
          "author": "Alexandre Thomas",
          "authorURL": "https://alexandrethm.github.io/",
          "affiliations": [
            {
              "name": "Mines ParisTech & Sorbonne University",
              "url": ""
            }
          ]
        },
        
        {
          "author": "Marc Lafon",
          "authorURL": "https://marclafon.github.io",
          "affiliations": [
            {
              "name": "Sorbonne University",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://marclafon.github.io/">
       <span class="font-weight-bold">Marc</span>   Lafon
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="post distill">

      <d-title>
        <h1>Deep double descent explained (4/4)</h1>
        <p>Recent works analyzing over-parameterized regimes.</p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        \[\newcommand{\Dn}{\mathcal{D}_n}
    \newcommand{\R}{\mathbb{R}}
    \newcommand{\LL}{\mathcal{L}}\]

<h2 id="optimization-in-the-over-parameterized-regime">Optimization in the over-parameterized regime</h2>

<p>For reasons that are still active research, overparameterization
seems beneficial not only in the statistical learning framework, but
from an optimization standpoint as well as it facilitates convergence to
global minima, in particular with the gradient descent procedures.</p>

<p>The optimization problem can be framed as minimizing a certain loss
function \(\LL(w)\) with respect to its parameters \(w \in \mathbb{R}^N\),
such as the square loss \(\LL(w) = \frac{1}{2} \sum_{i=1}^n (f(x_i, w) - y_i)^2\) where
\(\{(x_i, y_i)\}_{i=1}^{n}\) is our given training dataset and
\(f : (\mathbb{R}^d \times \mathbb{R}^N) \rightarrow \mathbb{R}\) is our
model.</p>

<blockquote>
  <p><strong>Exercise 2</strong>.
Assume that \(\ell: \mathcal{Y} \rightarrow \mathbb{R}\) is convex and
\(f : \mathcal{X} \rightarrow \mathcal{Y}\) is linear. Show that
\(\ell \circ f\) is convex.</p>
</blockquote>

<p>When \(f\) is non-linear however (which is habitually the case in deep
learning) the landscape of the loss function is generally non-convex.
Therefore, first order methods such as GD or SGD are likely to converge
and get trapped in spurious local minima, depending on the
initialization. Yet, in the over-parameterized regime where there are
multiple global minima interpolating almost perfectly the data, it seems
that SGD has no problem converging to these solutions, despite the
highly non-convex setting. Recent works are trying to explain this
phenomenon.</p>

<p>For instance, Oymak &amp; Soltanolkotabi (2020)<d-cite key="oymak2020toward"></d-cite>
shows that, for one-hidden layer neural
networks that <em>(1)</em> have smooth activation functions, <em>(2)</em> are
over-parameterized, i.e. \(N \geq C n^2\) where C depends on the
distribution of the data and <em>(3)</em> are initialized with i.i.d.
\(\mathcal{N}(0,1)\) entries, then with high probability GD converges
quickly to a global optimum. Similar results also hold for ReLU
activation functions and for SGD.</p>

<p>In Liu et al. (2020)<d-cite key="liu2020toward"></d-cite>, the authors show that sufficiently over-parameterized
systems, including wide neural networks, generally satisfy a condition
that allows gradient descent to converge efficiently, for a broad class
of problems. They use the PL-condition (from Polyak and Lojasiewicz <d-cite key="polyak1963gradient"></d-cite>)
 which does not require convexity but is sufficient for efficient minimization by GD. One key point is that the
loss function \(\LL(w)\) is generally non-convex in the neighborhood of
minimizers. Due to the over-parameterization, the Hessian matrices
\(\nabla^2 \LL(w)\) are positive semi-definite but not positive definite
in these neighborhoods, which is incompatible with convexity for
non-linear sets of solutions. This is in contrast to the
under-parameterized landscape which generally has multiple isolated
local minima with positive definite Hessian matrices. Figure
below illustrates this.</p>

<div class="l-page">
<div class="col-auto">
<img class="img-fluid rounded z-depth-1" src="/assets/img/posts/double-descent/loss_landscape.png" />
</div>
</div>
<div class="caption">
  <p><em>Left :</em> Loss landscape of under-parameterized models, locally convex
at local minima. <em>Right :</em> Loss landscape of over-parameterized models,
incompatible with local convexity. Taken from
Liu et al. (2020)<d-cite key="liu2020toward"></d-cite></p>
</div>

<p>In addition to better convergence guarantees, over-parameterization can
even accelerate optimization. By working with <em>linear</em> neural networks
(hence fixed expressiveness), Arora et al. (2018)<d-cite key="arora2018optimization"></d-cite> 
finds that increasing depth
has an implicit effect on gradient descent, combining certain forms of
<em>momentum</em> and <em>adaptive learning rates</em> (two well-known tools in the
field of optimization). They observe the acceleration for non-linear
networks as well (replacing weight matrices by a product of matrices,
for fixed expressiveness), and even when using explicit acceleration
methods such as Adam.</p>

<h2 id="neural-networks-as-a-physical-system--the-jamming-transition">Neural networks as a physical system : the jamming transition</h2>

<p>In order to study the loss landscape, Spigler et al. (2019)<d-cite key="spigler_jamming_2019"></d-cite> make an
analogy between neural networks and complex physical systems with
non-convex energy landscape, called glassy systems. Indeed, the loss
function can be interpreted as the potential energy of the system \(f\),
with a large number of parameters \(N\) (degrees of freedom). By
considering the hinge loss, the minimization of \(\LL(w;\Dn)\) actually
amounts to a constraint-classification problem (with \(n\) constraints,
\(N\) continuous degrees of freedom), already studied in physics.</p>

<p>Using this analogy, they show that the behavior of deep networks near
the interpolation point is similar to the behavior of some granular
systems, that undergo a critical <em>jamming transition</em> when their density
increases such that they are forced to be in contact one another. In the
under-parameterized regime, not all the training examples can be
classified correctly, which leads to unsatisfied constraints. But in the
over-parameterized regime, there is no stable local minima : the network
reaches a global minima zero training loss.</p>

<p>As illustrated in figure below, the authors are able to quantify
the location of the jamming transition in the \((n, N)\) plane
(considering \(N\) as the <em>effective</em> number of parameters of the
network). Considering a fully-connected network with arbitrary depth,
ReLU activation functions, and a dataset of size \(n\), they give a linear
upper bound on the critical number of parameters \(N^*\) characterizing
the jamming transition : \(N^* \leq \frac{1}{C_0} n\) where \(C_0\) is a
constant. In their experiments, it seems that the bound is tight for
random data but that \(N^*\) increases sub-linearly with \(n\) for
structured data (e.g. MNIST).</p>

<div class="l-body">
<div class="col-auto">
<img class="img-fluid rounded z-depth-1" src="/assets/img/posts/double-descent/jamming-transition.png" />
</div>
</div>
<div class="caption">
  <p>\(N\) : degrees of freedom, \(n\) : training examples. Inspired from
Spigler et al. <d-cite key="spigler2018jamming"></d-cite></p>
</div>

<p>Similarly to other works, they observe a peak in test error at the
jamming transition. In Geiger et al. (2020)<d-cite key="geiger2020scaling"></d-cite>,
using the same setting of fixed-depth fully-connected networks, they argue that this may be due to
\(||f||\) diverging near the interpolation point \(N=N^*\). Interestingly,
they also observe that near-optimal generalization can be obtained using
an ensemble average of networks with \(N\) slightly beyond \(N^*\).</p>

<h2 id="conclusion">Conclusion</h2>

<p>From a statistical learning point of view, deep learning is a
challenging setting to study, and some recent empirical successes are not
yet well understood. The double descent phenomenon, arising from
well-chosen inductive biases in the over-parameterized regime, has been
studied in linear settings <d-cite key="Belkin2019"></d-cite> and observed with deep
networks <d-cite key="Nakkiran2019"></d-cite>.</p>

<p>In addition to the references presented in this post, other lines of work seem promising.
Notably, <d-cite key="gissin2019implicit"></d-cite> <d-cite key="neyshabur2015path"></d-cite> <d-cite key="soudry2018implicit"></d-cite> <d-cite key="gunasekar2018implicit"></d-cite>
are working towards a better understanding of the implicit bias induced
by optimization algorithms. Finally, we refer the reader to <a href="http://misha.belkin-wang.org" target="\_blank">subsequent
works of Belkin et al.</a> such as <d-cite key="chen2020multiple"></d-cite>,
that finds <em>multiple descent</em> curves with an arbitrary number of peaks, due to the
interaction between the properties of the data and the inductive biases
of learning algorithms.</p>

      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

    </div>

    <!-- Footer -->

    
<footer class="sticky-bottom mt-5">
  <div class="container">
    &copy; Copyright 2022 Marc  Lafon.
    Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
    
  </div>
</footer>



  </body>

  <d-bibliography src="/assets/bibliography/2021-05-double-descent.bib">
  </d-bibliography>

</html>
